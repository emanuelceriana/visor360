var PhotoSphereViewer=function(e){var t=function(){var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl"))},o=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)},i=function(e,t,o){return Math.max(t,Math.min(o,e))},n=function(e,t,o,i){var n=o-e,r=i-t;return n*n+r*r},r=function(e,t){return(t=void 0!==t&&!!t)&&e==2*Math.PI?2*Math.PI:e-2*Math.floor(e/(2*Math.PI))*Math.PI};this.load=function(){if(ke.innerHTML="",Ke&&1===Ke.nodeType)ke.appendChild(Ke);else if(Ke&&"string"==typeof Ke)ke.innerHTML=Ke;else if(Ue){var e=document.createElement("img");e.setAttribute("src",Ue),e.setAttribute("alt",Ye),ke.appendChild(e)}else ke.textContent=Ye;var t;((Ee=document.createElement("div")).style.width="100%",Ee.style.height="100%",Ee.style.position="relative",Ee.style.overflow="hidden",(t=document.createElement("canvas")).getContext&&t.getContext("2d"))?void 0!==window.THREE?(be={width:0,height:0,ratio:0},Ne&&!Te.match(/^data:image\/[a-z]+;base64/)?s():l()):console.log("PhotoSphereViewer: Three.js is not loaded."):ke.textContent="Canvas is not supported, update your browser!"};var a=function(e,t){var o=e.indexOf("GPano:"+t)+t.length+8,i=e.indexOf('"',o);return-1==i&&(o=e.indexOf("GPano:"+t)+t.length+7,i=e.indexOf("<",o)),e.substring(o,i)},s=function(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window.ActiveXObject)return void(ke.textContent="XHR is not supported, update your browser!");try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}}e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=function(e){for(var t=0,o=0,i="";-1!=(t=e.indexOf("<x:xmpmeta",o))&&-1!=(o=e.indexOf("</x:xmpmeta>",t));)if(-1!=(i=e.substring(t,o)).indexOf("GPano:"))return i;return""}(e.responseText);if(!t.length)return void l();qe={full_width:parseInt(a(t,"FullPanoWidthPixels")),full_height:parseInt(a(t,"FullPanoHeightPixels")),cropped_width:parseInt(a(t,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(a(t,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(a(t,"CroppedAreaLeftPixels")),cropped_y:parseInt(a(t,"CroppedAreaTopPixels"))},je=!0,l()}},e.open("GET",Te,!0),e.send(null)},l=function(){var e=new Image;e.onload=function(){var o={full_width:e.width,full_height:e.height,cropped_width:e.width,cropped_height:e.height,cropped_x:null,cropped_y:null};if(360!=Ve.horizontal_fov||180!=Ve.vertical_fov){if(qe.cropped_width=o.cropped_width,qe.cropped_height=o.cropped_height,qe.full_width=o.full_width,qe.full_height=o.full_height,360!=Ve.horizontal_fov){var i=Ve.horizontal_fov/360;qe.full_width=qe.cropped_width/i}if(180!=Ve.vertical_fov){var n=Ve.vertical_fov/180;qe.full_height=qe.cropped_height/n}}else{for(var r in qe)null===qe[r]&&void 0!==o[r]&&(qe[r]=o[r]);if(je){if(qe.cropped_width!=o.cropped_width){var a=o.cropped_width/qe.cropped_width;qe.cropped_width=o.cropped_width,qe.full_width*=a,qe.cropped_x*=a}if(qe.cropped_height!=o.cropped_height){var s=o.cropped_height/qe.cropped_height;qe.cropped_height=o.cropped_height,qe.full_height*=s,qe.cropped_y*=s}}}null===qe.cropped_x&&(qe.cropped_x=(qe.full_width-qe.cropped_width)/2),null===qe.cropped_y&&(qe.cropped_y=(qe.full_height-qe.cropped_height)/2);var l=2048;if(t()){var c=document.createElement("canvas").getContext("webgl");l=c.getParameter(c.MAX_TEXTURE_SIZE)}var u=Math.min(qe.full_width,l),h=u/qe.full_width;qe.full_width=u,qe.cropped_width*=h,qe.cropped_x*=h,e.width=qe.cropped_width,qe.full_height*=h,qe.cropped_height*=h,qe.cropped_y*=h,e.height=qe.cropped_height;var p=document.createElement("canvas");p.width=qe.full_width,p.height=qe.full_height,p.getContext("2d").drawImage(e,qe.cropped_x,qe.cropped_y,qe.cropped_width,qe.cropped_height),d(p.toDataURL("image/jpeg"))},$e&&!Te.match(/^data:image\/[a-z]+;base64/)&&e.setAttribute("crossOrigin","anonymous"),e.src=Te},d=function(e){var t=new THREE.Texture;(new THREE.ImageLoader).load(e,function(e){t.needsUpdate=!0,t.image=e,c(t)})},c=function(e){void 0!==Ce.width&&(ke.style.width=Ce.width.css),void 0!==Ce.height&&(ke.style.height=Ce.height.css),m(),(Re=t()?new THREE.WebGLRenderer:new THREE.CanvasRenderer).setSize(be.width,be.height),Ie=new THREE.Scene,(Me=new THREE.PerspectiveCamera(U,be.ratio,1,300)).position.set(0,0,0),Ie.add(Me);var i=new THREE.SphereGeometry(200,re,ne),n=new THREE.MeshBasicMaterial({map:e,overdraw:!0}),r=new THREE.Mesh(i,n);if(r.scale.x=-1,Ie.add(r),(Se=document.createElement("div")).style.position="absolute",Se.style.zIndex=0,Ee.appendChild(Se),me&&(ve.setStyle(fe),ve.create(),Ee.appendChild(ve.getBar())),null!==Ze){var a=document.createElement("img");a.onload=function(){a.style.display="block",a.style.position="absolute",a.style[Ze.position.x]="5px",a.style[Ze.position.y]="5px","bottom"==Ze.position.y&&me&&(a.style.bottom=ve.getBar().offsetHeight+5+"px"),void 0!==Ze.size&&(a.style.width=Ze.size.width,a.style.height=Ze.size.height),Ee.appendChild(a)},a.src=Ze.image}o(window,"resize",m),ye&&(o(Se,"mousedown",_),o(document,"mousemove",S),o(Se,"mousemove",O),o(document,"mouseup",E),o(Se,"touchstart",k),o(document,"touchend",E),o(document,"touchmove",T),we&&(o(Se,"mousewheel",P),o(Se,"DOMMouseScroll",P)),Je.addAction("fullscreen-mode",w)),o(document,"fullscreenchange",B),o(document,"mozfullscreenchange",B),o(document,"webkitfullscreenchange",B),o(document,"MSFullscreenChange",B),Xe.addListener(M),ke.innerHTML="",ke.appendChild(Ee);var s=Re.domElement;s.style.display="block",Se.appendChild(s),u(),ae>0&&H(ae),h(),X("ready")},u=function(){var e=new THREE.Vector3;e.setX(Math.cos(te)*Math.sin(oe)),e.setY(Math.sin(te)),e.setZ(Math.cos(te)*Math.cos(oe)),Me.lookAt(e),null!==Pe?Pe.render(Ie,Me):Re.render(Ie,Me)};this.toggleStereo=function(){null!==Pe?(Pe=null,Re.setSize(be.width,be.height),ve.mustBeHidden(!1),u(),X("stereo-effect",!1)):((Pe=new THREE.StereoEffect(Re)).eyeSeparation=_e,Pe.setSize(be.width,be.height),I(),A(),ve.mustBeHidden(),u(),X("stereo-effect",!0))};var h=function(){!1!==de&&(De=setTimeout(g,de))},p=function(){te-=(te-pe)*he,oe+=ce;var e=!0;ee||(oe=i(oe,W,N))!=W&&oe!=N||(ue?ce*=-1:(v(),e=!1)),oe=r(oe,!0),X("position-updated",{longitude:oe,latitude:te}),u(),e&&(Le=setTimeout(p,le))},g=function(){p(),X("autorotate",!0)},v=function(){clearTimeout(De),De=null,clearTimeout(Le),Le=null,X("autorotate",!1)};this.toggleAutorotate=function(){clearTimeout(De),Le?v():g()};var m=function(){ke.clientWidth==be.width&&ke.clientHeight==be.height||f({width:ke.clientWidth,height:ke.clientHeight})};this.fitToContainer=function(){m()};var f=function(e){be.width=void 0!==e.width?parseInt(e.width):be.width,be.height=void 0!==e.height?parseInt(e.height):be.height,be.ratio=be.width/be.height,Me&&(Me.aspect=be.ratio,Me.updateProjectionMatrix()),Re&&(Re.setSize(be.width,be.height),u()),Pe&&(Pe.setSize(be.width,be.height),u())};this.getPosition=function(){return{longitude:oe,latitude:te}},this.getPositionInDegrees=function(){return{longitude:180*oe/Math.PI,latitude:180*te/Math.PI}};var y=function(e,t){var o=D(e);ee||(o=i(o,W,N));var n=D(t);n>Math.PI&&(n-=2*Math.PI),n=i(n,Z,K),X("position-updated",{longitude:oe=o,latitude:te=n}),u()};this.moveTo=function(e,t){y(e,t)};var b=function(e,t){e=D(e),t=D(t),y(oe+e,te+t)};this.rotate=function(e,t){b(e,t)};var w=function(e){(e?window.addEventListener:window.removeEventListener)("keydown",x)},x=function(e){var t=0,o=0;switch(function(e){if(e.key)return/^Arrow/.test(e.key)?e.key:"Arrow"+e.key;if(e.keyCode||e.which){var t=e.keyCode?e.keyCode:e.which,o={38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",37:"ArrowLeft"};if(void 0!==o[t])return o[t]}return""}(e)){case"ArrowUp":o=j;break;case"ArrowRight":t=-V;break;case"ArrowDown":o=-j;break;case"ArrowLeft":t=V}b(t,o)},_=function(e){C(parseInt(e.clientX),parseInt(e.clientY))},k=function(e){if(1==e.touches.length){var t=e.touches[0];t.target.parentNode==Se&&C(parseInt(t.clientX),parseInt(t.clientY))}else 2==e.touches.length&&(E(),e.touches[0].target.parentNode==Se&&e.touches[1].target.parentNode==Se&&z(n(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY)));O()},C=function(e,t){Fe=e,Be=t,v(),He=!0},z=function(e){Oe=e,Ae=!0},E=function(e){He=!1,Ae=!1},S=function(e){e.preventDefault(),R(parseInt(e.clientX),parseInt(e.clientY))},T=function(e){if(1==e.touches.length&&He){var t=e.touches[0];t.target.parentNode==Se&&(e.preventDefault(),R(parseInt(t.clientX),parseInt(t.clientY)))}else if(2==e.touches.length&&e.touches[0].target.parentNode==Se&&e.touches[1].target.parentNode==Se&&Ae){e.preventDefault();var o=n(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY),i=o-Oe;if(0!==i){var r=i/Math.abs(i);H(ae+r*xe),Oe=o}}},R=function(e,t){He&&($?(oe+=(e-Fe)/be.height*se*Math.PI/180,te+=(t-Be)/be.height*se*Math.PI/180):(oe+=(e-Fe)*q,te+=(t-Be)*G),Fe=e,Be=t,ee||(oe=i(oe,W,N)),oe=r(oe,!0),te=i(te,Z,K),X("position-updated",{longitude:oe,latitude:te}),u())},I=function(){Xe.start(),v(),X("device-orientation",!0)};this.toggleDeviceOrientation=function(){Xe.isEventAttached()?(Xe.stop(),X("device-orientation",!1)):I()};var M=function(e){oe=i(e.longitude,W,N),te=i(e.latitude,Z,K),X("position-updated",{longitude:oe,latitude:te}),u()},P=function(e){e.preventDefault(),e.stopPropagation();var t=e.detail?-e.detail:e.wheelDelta;if(0!==t){var o=parseInt(t/Math.abs(t));H(ae+o*xe)}};this.mouseWheel=function(e){P(e)};var H=function(e){ae=i(e,0,100),se=U+ae/100*(Y-U),Me.fov=se,Me.updateProjectionMatrix(),u(),X("zoom-updated",ae)};this.getZoomLevel=function(){return ae},this.zoom=function(e){H(e)},this.zoomIn=function(){ae<100&&H(ae+xe)},this.zoomOut=function(){ae>0&&H(ae-xe)};var F=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},B=function(){document.webkitFullscreenElement||document.msFullscreenElement?(ze.width=ke.style.width,ze.height=ke.style.height,ke.style.width="100%",ke.style.height="100%",m()):(ke.webkitRequestFullscreen||ke.msRequestFullscreen)&&(ke.style.width=ze.width,ke.style.height=ze.height,m()),X("fullscreen-mode",F())},A=function(){ke.requestFullscreen?ke.requestFullscreen():ke.mozRequestFullScreen?ke.mozRequestFullScreen():ke.webkitRequestFullscreen?ke.webkitRequestFullscreen():ke.msRequestFullscreen&&ke.msRequestFullscreen()};this.toggleFullscreen=function(){F()?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():A()};var O=function(){me&&ve.show()},L=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),o=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();o.match(/(pm|per minute)$/)&&(t/=60);var i=0;switch(o){case"rpm":case"rev per minute":case"revolutions per minute":case"rps":case"rev per second":case"revolutions per second":i=2*t*Math.PI;break;case"dpm":case"deg per minute":case"degrees per minute":case"dps":case"deg per second":case"degrees per second":i=t*Math.PI/180;break;case"rad per minute":case"radians per minute":case"rad per second":case"radians per second":i=t;break;default:m_anim=!1}return i*le/1e3},D=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));return"deg"==e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim()&&(t*=Math.PI/180),r(t)};this.addAction=function(e,t){e in We||(We[e]=[]),We[e].push(t)};var X=function(e,t){if(e in We&&We[e].length)for(var o=0,i=We[e].length;o<i;++o)void 0!==t?We[e][o](t):We[e][o]()};if(void 0!==e&&void 0!==e.panorama&&void 0!==e.container){var W,N,$=void 0===e.smooth_user_moves||!!e.smooth_user_moves,q=void 0!==e.long_offset?D(e.long_offset):Math.PI/360,G=void 0!==e.lat_offset?D(e.lat_offset):Math.PI/180,V=void 0!==e.keyboard_long_offset?D(e.keyboard_long_offset):Math.PI/60,j=void 0!==e.keyboard_lat_offset?D(e.keyboard_lat_offset):Math.PI/120,Y=void 0!==e.min_fov?i(parseFloat(e.min_fov),1,179):30,U=void 0!==e.max_fov?i(parseFloat(e.max_fov),1,179):90,K=void 0!==e.tilt_up_max?i(D(e.tilt_up_max),0,Math.PI/2):Math.PI/2,Z=void 0!==e.tilt_down_max?-i(D(e.tilt_down_max),0,Math.PI/2):-Math.PI/2,J=void 0!==e.min_longitude?D(e.min_longitude):0,Q=void 0!==e.max_longitude?D(e.max_longitude):0,ee=J==Q;ee?(J=0,Q=2*Math.PI):0===Q&&(Q=2*Math.PI),J<Q?(W=J,N=Q):(W=Q,N=J);var te=0,oe=W;if(void 0!==e.default_position){if(void 0!==e.default_position.lat){var ie=D(e.default_position.lat);ie>Math.PI&&(ie-=2*Math.PI),te=i(ie,Z,K)}void 0!==e.default_position.long&&(oe=i(D(e.default_position.long),W,N))}var ne=void 0!==e.segments?parseInt(e.segments):100,re=void 0!==e.rings?parseInt(e.rings):100,ae=0;void 0!==e.zoom_level&&(ae=i(parseInt(Math.round(e.zoom_level)),0,100));var se=U+ae/100*(Y-U),le=1e3/60,de=2e3;void 0!==e.time_anim&&(de="number"==typeof e.time_anim&&e.time_anim>=0&&e.time_anim);var ce=void 0!==e.anim_speed?L(e.anim_speed):L("2rpm"),ue=!0;void 0!==e.reverse_anim&&(ue=!!e.reverse_anim);var he=void 0!==e.vertical_anim_speed?L(e.vertical_anim_speed):L("2rpm"),pe=0;if(void 0!==e.vertical_anim_target){var ge=D(e.vertical_anim_target);ge>Math.PI&&(ge-=2*Math.PI),pe=i(ge,Z,K)}var ve=new PSVNavBar(this),me=void 0!==e.navbar&&!!e.navbar,fe=void 0!==e.navbar_style?e.navbar_style:{},ye=void 0===e.allow_user_interactions||!!e.allow_user_interactions;ye||(me=!1);var be,we=void 0===e.allow_scroll_to_zoom||!!e.allow_scroll_to_zoom,xe=void 0!==e.zoom_speed?parseFloat(e.zoom_speed):1,_e=void 0!==e.eyes_offset?parseFloat(e.eyes_offset):5,ke="string"==typeof e.container?document.getElementById(e.container):e.container,Ce={},ze={};void 0!==e.size&&function(e){for(var t in e)if("width"==t||"height"==t){var o=e[t].toString().trim(),i=parseFloat(o.replace(/^([0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=o.replace(/^[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();"%"!=n&&(n="px"),Ce[t]={css:i+n,unit:n}}}(e.size);var Ee,Se,Te=e.panorama,Re=null,Ie=null,Me=null,Pe=null,He=!1,Fe=0,Be=0,Ae=!1,Oe=0,Le=null,De=null,Xe=new Sphoords,We={},Ne=void 0===e.usexmpdata||!!e.usexmpdata,$e=void 0===e.cors_anonymous||!!e.cors_anonymous,qe={full_width:null,full_height:null,cropped_width:null,cropped_height:null,cropped_x:null,cropped_y:null};if(void 0!==e.pano_size){for(var Ge in qe)void 0!==e.pano_size[Ge]&&(qe[Ge]=parseInt(e.pano_size[Ge]));Ne=!1}var Ve={horizontal_fov:360,vertical_fov:180};if(void 0!==e.captured_view){for(var Ge in Ve)void 0!==e.captured_view[Ge]&&(Ve[Ge]=parseFloat(e.captured_view[Ge]));Ne=!1}var je=!1,Ye=void 0!==e.loading_msg?e.loading_msg.toString():"Se está cargando la imágen 360 en alta calidad para una mejor experiencia, esto podria tardar varios segundos...",Ue=void 0!==e.loading_img?e.loading_img.toString():null,Ke=void 0!==e.loading_html?e.loading_html:null,Ze=null;void 0!==e.overlay&&void 0!==e.overlay.image&&(Ze={image:e.overlay.image,position:{x:"center",y:"center"}},void 0!==e.overlay.position&&(void 0===e.overlay.position.x||"left"!=e.overlay.position.x&&"right"!=e.overlay.position.x||(Ze.position.x=e.overlay.position.x),void 0===e.overlay.position.y||"top"!=e.overlay.position.y&&"bottom"!=e.overlay.position.y||(Ze.position.y=e.overlay.position.y)),void 0!==e.overlay.size&&(Ze.size={width:void 0!==e.overlay.size.width?e.overlay.size.width:"auto",height:void 0!==e.overlay.size.height?e.overlay.size.height:"auto"}));var Je=this;void 0!==e.onready&&this.addAction("ready",e.onready),(void 0===e.autoload||!!e.autoload)&&this.load()}else console.log("PhotoSphereViewer: no value given for panorama or container")},PSVNavBar=function(e){var t=function(e,t){for(var o=0,i=t.length;o<i;++o)if(t[o]==e)return!0;return!1};this.setStyle=function(e){for(var o in e)o in c&&(i=o,n=e[o],t(i,u)&&"string"==typeof n&&("transparent"==n||n.match(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/)||n.match(/^rgb\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(,\s*(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}\)$/)||n.match(/^rgba\(((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),\s*){3}(0(\.[0-9]*)?|1)\)$/))||t(i,h)&&!isNaN(parseFloat(n))&&isFinite(n)&&n>=0)&&(c[o]=e[o]);var i,n},this.create=function(){(n=document.createElement("div")).style.backgroundColor=c.backgroundColor,n.style.position="absolute",n.style.zIndex=10,n.style.bottom=0,n.style.width="100%",n.style.boxSizing="content-box",n.style.transition="bottom 0.4s ease-out",r=new PSVNavBarButton(e,"autorotate",c),n.appendChild(r.getButton()),a=new PSVNavBarButton(e,"zoom",c),n.appendChild(a.getButton()),s=new PSVNavBarButton(e,"fullscreen",c),n.appendChild(s.getButton()),Sphoords.isDeviceOrientationSupported&&(l=new PSVNavBarButton(e,"orientation",c),n.appendChild(l.getButton()),d=new PSVNavBarButton(e,"virtual-reality",c),n.appendChild(d.getButton()))},this.getBar=function(){return n};var o=function(){p&&(clearTimeout(p),!g&&v&&(p=setTimeout(i,5e3))),g&&(n.style.bottom=0,g=!1,v&&(p=setTimeout(i,5e3)))};this.show=function(){o()};var i=function(){g||(n.style.bottom=1-n.offsetHeight+"px",g=!0)};this.hide=function(){i()},this.isHidden=function(){return g},this.mustBeHidden=function(e){(v=void 0===e||!!e)?i():o()};var n,r,a,s,l,d,c={backgroundColor:"rgba(61, 61, 61, 0.5)",buttonsColor:"rgba(255, 255, 255, 0.7)",buttonsBackgroundColor:"transparent",activeButtonsBackgroundColor:"rgba(255, 255, 255, 0.1)",buttonsHeight:20,autorotateThickness:1,zoomRangeWidth:50,zoomRangeThickness:1,zoomRangeDisk:7,fullscreenRatio:4/3,fullscreenThickness:2,gyroscopeThickness:1,virtualRealityRatio:4/3,virtualRealityBorderRadius:2},u=["backgroundColor","buttonsColor","buttonsBackgroundColor","activeButtonsBackgroundColor"],h=["buttonsHeight","autorotateThickness","zoomRangeWidth","zoomRangeThickness","zoomRangeDisk","fullscreenRatio","fullscreenThickness"],p=null,g=!1,v=!1},PSVNavBarButton=function(e,t,o){var i=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)};this.getButton=function(){return s};var n,r,a,s,l=function(e){s.style.backgroundColor=e?o.activeButtonsBackgroundColor:o.buttonsBackgroundColor},d=function(e){a.style.left=e/100*o.zoomRangeWidth-o.zoomRangeDisk/2+"px"},c=function(e){h(parseInt(e.clientX))},u=function(e){var t=e.touches[0];t.target!=n&&t.target!=r&&t.target!=a||h(parseInt(t.clientX))},h=function(e){y=!0,m(e)},p=function(e){y=!1},g=function(e){e.preventDefault(),m(parseInt(e.clientX))},v=function(e){var t=e.touches[0];t.target!=n&&t.target!=r&&t.target!=a||(e.preventDefault(),m(parseInt(t.clientX)))},m=function(t){if(y){var i=(t-r.getBoundingClientRect().left)/o.zoomRangeWidth*100;e.zoom(i)}},f=function(t){e.mouseWheel(t)},y=!1;!function(){switch(t){case"autorotate":var h=o.buttonsHeight-2*o.autorotateThickness,m=h/10;(s=document.createElement("div")).style.cssFloat="left",s.style.boxSizing="inherit",s.style.padding="10px",s.style.width=o.buttonsHeight+"px",s.style.height=o.buttonsHeight+"px",s.style.backgroundColor=o.buttonsBackgroundColor,s.style.position="relative",s.style.cursor="pointer",i(s,"click",function(){e.toggleAutorotate()});var y=document.createElement("div");y.style.boxSizing="inherit",y.style.width=h+"px",y.style.height=h+"px",y.style.borderRadius="50%",y.style.border=o.autorotateThickness+"px solid "+o.buttonsColor,s.appendChild(y);var b=document.createElement("div");b.style.boxSizing="inherit",b.style.width=h+"px",b.style.height=m+"px",b.style.borderRadius="50%",b.style.border=o.autorotateThickness+"px solid "+o.buttonsColor,b.style.position="absolute",b.style.top="50%",b.style.marginTop=-(m/2+o.autorotateThickness)+"px",s.appendChild(b),e.addAction("autorotate",l);break;case"zoom":(s=document.createElement("div")).style.cssFloat="left",s.style.boxSizing="inherit";var w=document.createElement("div");w.style.cssFloat="left",w.style.boxSizing="inherit",w.style.padding="10px",w.style.height=o.buttonsHeight+"px",w.style.backgroundColor=o.buttonsBackgroundColor,w.style.lineHeight=o.buttonsHeight+"px",w.style.color=o.buttonsColor,w.style.cursor="pointer",w.textContent="-",i(w,"click",function(){e.zoomOut()}),s.appendChild(w),(n=document.createElement("div")).style.cssFloat="left",n.style.boxSizing="inherit",n.style.padding=10+(o.buttonsHeight-o.zoomRangeThickness)/2+"px 5px",n.style.backgroundColor=o.buttonsBackgroundColor,n.style.cursor="pointer",s.appendChild(n),(r=document.createElement("div")).style.boxSizing="inherit",r.style.width=o.zoomRangeWidth+"px",r.style.height=o.zoomRangeThickness+"px",r.style.backgroundColor=o.buttonsColor,r.style.position="relative",n.appendChild(r),(a=document.createElement("div")).style.position="absolute",a.style.top=(o.zoomRangeThickness-o.zoomRangeDisk)/2+"px",a.style.left=-o.zoomRangeDisk/2+"px",a.style.boxSizing="inherit",a.style.width=o.zoomRangeDisk+"px",a.style.height=o.zoomRangeDisk+"px",a.style.borderRadius="50%",a.style.backgroundColor=o.buttonsColor,e.addAction("zoom-updated",d),i(n,"mousedown",c),i(n,"touchstart",u),i(document,"mousemove",g),i(document,"touchmove",v),i(document,"mouseup",p),i(document,"touchend",p),i(n,"mousewheel",f),i(n,"DOMMouseScroll",f),r.appendChild(a);var x=document.createElement("div");x.style.cssFloat="left",x.style.boxSizing="inherit",x.style.padding="10px",x.style.height=o.buttonsHeight+"px",x.style.backgroundColor=o.buttonsBackgroundColor,x.style.lineHeight=o.buttonsHeight+"px",x.style.color=o.buttonsColor,x.style.cursor="pointer",x.textContent="+",i(x,"click",function(){e.zoomIn()}),s.appendChild(x);break;case"fullscreen":var _=o.buttonsHeight*o.fullscreenRatio,k=.3*o.buttonsHeight,C=(o.buttonsHeight-k)/2,z=.3*_,E=(_-z)/2-o.fullscreenThickness,S=o.buttonsHeight-2*o.fullscreenThickness;(s=document.createElement("div")).style.cssFloat="right",s.style.boxSizing="inherit",s.style.padding="10px",s.style.width=_+"px",s.style.height=o.buttonsHeight+"px",s.style.backgroundColor=o.buttonsBackgroundColor,s.style.cursor="pointer",i(s,"click",function(){e.toggleFullscreen()});var T=document.createElement("div");T.style.cssFloat="left",T.style.boxSizing="inherit",T.style.width=o.fullscreenThickness+"px",T.style.height=k+"px",T.style.borderStyle="solid",T.style.borderColor=o.buttonsColor+" transparent",T.style.borderWidth=C+"px 0",s.appendChild(T);var R=document.createElement("div");R.style.cssFloat="left",R.style.boxSizing="inherit",R.style.width=E+"px",R.style.height=S+"px",R.style.borderStyle="solid",R.style.borderColor=o.buttonsColor+" transparent",R.style.borderWidth=o.fullscreenThickness+"px 0",s.appendChild(R);var I=document.createElement("div");I.style.cssFloat="left",I.style.boxSizing="inherit",I.style.marginLeft=z+"px",I.style.width=E+"px",I.style.height=S+"px",I.style.borderStyle="solid",I.style.borderColor=o.buttonsColor+" transparent",I.style.borderWidth=o.fullscreenThickness+"px 0",s.appendChild(I);var M=document.createElement("div");M.style.cssFloat="left",M.style.boxSizing="inherit",M.style.width=o.fullscreenThickness+"px",M.style.height=k+"px",M.style.borderStyle="solid",M.style.borderColor=o.buttonsColor+" transparent",M.style.borderWidth=C+"px 0",s.appendChild(M);var P=document.createElement("div");P.style.clear="left",s.appendChild(P),e.addAction("fullscreen-mode",l);break;case"orientation":var H=o.buttonsHeight-2*o.gyroscopeThickness,F=H-4*o.gyroscopeThickness,B=H/10;(s=document.createElement("div")).style.cssFloat="right",s.style.boxSizing="inherit",s.style.padding="10px",s.style.width=o.buttonsHeight+"px",s.style.height=o.buttonsHeight+"px",s.style.backgroundColor=o.buttonsBackgroundColor,s.style.position="relative",s.style.cursor="pointer",i(s,"click",function(){e.toggleDeviceOrientation()});var A=document.createElement("div");A.style.boxSizing="inherit",A.style.width=H+"px",A.style.height=H+"px",A.style.borderRadius="50%",A.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,s.appendChild(A);var O=document.createElement("div");O.style.boxSizing="inherit",O.style.width=F+"px",O.style.height=B+"px",O.style.borderRadius="50%",O.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,O.style.position="absolute",O.style.top="50%",O.style.left="50%",O.style.marginTop=-(B/2+o.gyroscopeThickness)+"px",O.style.marginLeft=-(F/2+o.gyroscopeThickness)+"px",s.appendChild(O);var L=document.createElement("div");L.style.boxSizing="inherit",L.style.width=B+"px",L.style.height=F+"px",L.style.borderRadius="50%",L.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,L.style.position="absolute",L.style.top="50%",L.style.left="50%",L.style.marginTop=-(F/2+o.gyroscopeThickness)+"px",L.style.marginLeft=-(B/2+o.gyroscopeThickness)+"px",s.appendChild(L),e.addAction("device-orientation",l);break;case"virtual-reality":var D=o.buttonsHeight*o.virtualRealityRatio,X=D/4,W=X/2;(s=document.createElement("div")).style.cssFloat="right",s.style.position="relative",s.style.boxSizing="inherit",s.style.padding="10px",s.style.width=D+"px",s.style.height=o.buttonsHeight+"px",s.style.backgroundColor=o.buttonsBackgroundColor,s.style.cursor="pointer",i(s,"click",function(){e.toggleStereo()});var N=document.createElement("div");N.style.boxSizing="inherit",N.style.width=D+"px",N.style.height=o.buttonsHeight+"px",N.style.borderRadius=o.virtualRealityBorderRadius+"px",N.style.backgroundColor=o.buttonsColor,s.appendChild(N);var $=document.createElement("div");$.style.boxSizing="inherit",$.style.width=X+"px",$.style.height=X+"px",$.style.position="absolute",$.style.top=W+10+"px",$.style.left=W+10+"px",$.style.borderRadius="50%",$.style.backgroundColor=o.backgroundColor,s.appendChild($);var q=document.createElement("div");q.style.boxSizing="inherit",q.style.width=X+"px",q.style.height=X+"px",q.style.position="absolute",q.style.top=W+10+"px",q.style.right=W+10+"px",q.style.borderRadius="50%",q.style.backgroundColor=o.backgroundColor,s.appendChild(q);var G=document.createElement("div");G.style.boxSizing="inherit",G.style.width=X+"px",G.style.height=o.buttonsHeight/2+"px",G.style.position="absolute",G.style.left="50%",G.style.bottom="10px",G.style.marginLeft=-X/2+"px",G.style.borderTopLeftRadius="50% 60%",G.style.borderTopRightRadius="50% 60%",G.style.backgroundColor=o.backgroundColor,s.appendChild(G),e.addAction("stereo-effect",l)}}()},Sphoords=function(){var e=function(e){return e-360*Math.floor(e/360)};this.start=function(){return Sphoords.isDeviceOrientationSupported?(window.addEventListener("deviceorientation",t,!1),n=!0,!0):(console.log("Device Orientation API not supported"),!1)},this.stop=function(){n&&(window.removeEventListener("deviceorientation",t,!1),n=!1)},this.toggle=function(){n?this.stop():this.start()},this.isEventAttached=function(){return n};var t=function(t){var o=0,n=0;switch(c=Sphoords.getScreenOrientation()){case"portrait-primary":o=t.alpha+t.gamma,n=t.beta-90;break;case"landscape-primary":if(o=t.alpha+t.beta-90,n=-t.gamma-90,Math.abs(t.beta)>90)switch(u){case"Blink":n+=180;break;case"Gecko":default:n=-n}"WebKit"===u&&window.orientation&&(n<0&&(n=-1*(n+180)),o>=180?o-=180:o+=180);break;case"landscape-secondary":if(o=t.alpha-t.beta+90,n=t.gamma-90,Math.abs(t.beta)>90)switch(u){case"Blink":n+=180;break;case"Gecko":default:n=-n}"WebKit"===u&&window.orientation&&(n<0&&(n=-1*(n+180)),o>=180?o-=180:o+=180);break;case"portrait-secondary":o=t.alpha-t.gamma,n=180-(t.beta-90),n=270-t.beta}(n=e(n))>=180&&(n-=360),r=e(o),a=Math.max(-90,Math.min(90,n)),s=r*d,l=a*d,i()};this.getCoordinates=function(){return{longitude:s,latitude:l}},this.getCoordinatesInDegrees=function(){return{longitude:r,latitude:a}},this.getScreenOrientation=function(){return c},this.addListener=function(e){h.push(e)};var o,i=function(){if(h.length)for(var e=0,t=h.length;e<t;++e)h[e]({longitude:s,latitude:l})},n=!1,r=0,a=0,s=0,l=0,d=Math.PI/180,c=Sphoords.getScreenOrientation(),u=(o=navigator.userAgent,/Gecko\/[0-9.]+/.test(o)?"Gecko":/Chrome\/[0-9.]+/.test(o)?"Blink":/AppleWebKit\/[0-9.]+/.test(o)?"WebKit":/Trident\/[0-9.]+/.test(o)?"Trident":/Opera\/[0-9.]+/.test(o)?"Presto":"Gecko"),h=[]};Sphoords.getScreenOrientation=function(){var e=null;if(screen.orientation)e=screen.orientation;else if(screen.mozOrientation)e=screen.mozOrientation;else if(screen.msOrientation)e=screen.msOrientation;else if(window.orientation||0===window.orientation)switch(window.orientation){case 0:e="portrait-primary";break;case 180:e="portrait-secondary";break;case-90:e="landscape-primary";break;case 90:e="landscape-secondary"}return null!==e&&"object"==typeof e?e.type:e},Sphoords.isDeviceOrientationSupported=!1,function(){if(window.DeviceOrientationEvent&&null!==Sphoords.getScreenOrientation()){window.addEventListener("deviceorientation",function e(t){null!==t&&null!==t.alpha&&(Sphoords.isDeviceOrientationSupported=!0,window.removeEventListener("deviceorientation",e))})}}();